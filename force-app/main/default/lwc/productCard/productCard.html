<template>
    <div class="product-card slds-card slds-card_boundary"
         onclick={handleCardClick}
         role="button"
         tabindex="0"
         onkeydown={handleKeyDown}
         aria-label={productAriaLabel}>

        <div class="product-image-container">
            <img src={product.imageUrl}
                 alt={product.imageAlt}
                 class="product-image"
                 loading="lazy">

            <template lwc:if={product.isOnSale}>
                <span class="slds-badge sale-badge">Sale</span>
            </template>

            <template lwc:if={product.isNew}>
                <span class="slds-badge new-badge">New</span>
            </template>
        </div>

        <div class="slds-card__body slds-card__body_inner">
            <h3 class="slds-text-heading_small slds-truncate product-title">
                {product.name}
            </h3>

            <div class="product-rating slds-m-vertical_x-small">
                <template for:each={ratingStars} for:item="star">
                    <lightning-icon key={star.id}
                        icon-name="utility:favorite"
                        size="xx-small"
                        class={star.class}>
                    </lightning-icon>
                </template>
                <span class="slds-text-body_small slds-m-left_x-small">
                    ({product.reviewCount})
                </span>
            </div>

            <div class="product-price slds-m-bottom_small">
                <template lwc:if={product.originalPrice}>
                    <span class="original-price slds-text-body_small">${product.originalPrice}</span>
                </template>
                <span class="current-price slds-text-heading_small">${product.currentPrice}</span>
            </div>

            <template lwc:if={showDescription}>
                <p class="slds-text-body_small slds-text-color_weak product-description">
                    {product.shortDescription}
                </p>
            </template>
        </div>

        <div class="slds-card__footer">
            <div class="slds-grid slds-grid_align-spread">
                <lightning-button
                    label="Add to Cart"
                    variant="brand"
                    onclick={handleAddToCart}
                    class="add-to-cart-btn"
                    disabled={product.outOfStock}>
                </lightning-button>

                <lightning-button-icon
                    icon-name={favoriteIcon}
                    variant="bare"
                    alternative-text="Add to wishlist"
                    onclick={handleToggleFavorite}
                    class={favoriteClass}>
                </lightning-button-icon>
            </div>
        </div>
    </div>
</template>